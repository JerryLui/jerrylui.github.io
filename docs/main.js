var c=Object.defineProperty;var p=(o,t,e)=>t in o?c(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var r=(o,t,e)=>p(o,typeof t!="symbol"?t+"":t,e);import*as n from"three";import{OrbitControls as m}from"three/addons/controls/OrbitControls.js";import{GLTFLoader as u}from"three/addons/loaders/GLTFLoader.js";import{DRACOLoader as g}from"three/addons/loaders/DRACOLoader.js";var h=class{constructor(){r(this,"container");r(this,"progressBar");r(this,"currentProgress",0);r(this,"targetProgress",0);r(this,"MINIMUM_LOAD_TIME",2e3);r(this,"loadStartTime");r(this,"isAnimating",!0);r(this,"onComplete");r(this,"animate",()=>{this.isAnimating&&(this.targetProgress<90&&this.currentProgress<90&&(this.targetProgress+=.1),this.currentProgress+=(this.targetProgress-this.currentProgress)*.1,this.progressBar.style.width=`${this.currentProgress}%`,requestAnimationFrame(this.animate))});this.container=document.querySelector(".loading-bar"),this.progressBar=document.querySelector(".loading-progress"),this.loadStartTime=performance.now(),this.animate()}updateProgress(t){this.targetProgress=t}hide(t){this.onComplete=t;let e=performance.now()-this.loadStartTime,i=Math.max(0,this.MINIMUM_LOAD_TIME-e);this.targetProgress=100,setTimeout(()=>{this.isAnimating=!1,this.container.style.display="none",this.onComplete?.()},i)}showError(){this.container.style.backgroundColor="rgba(255, 0, 0, 0.3)",this.isAnimating=!1}},d=class{constructor(t,e){r(this,"element");r(this,"position");r(this,"velocity");r(this,"colorTransition",0);r(this,"currentColorIndex",0);r(this,"isPaused",!1);r(this,"COLORS",["#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#ffeaa7","#dda0dd","#98d8c8","#fd79a8"]);r(this,"COLOR_TRANSITION_SPEED",.01);r(this,"VELOCITY",{x:2,y:1.5});r(this,"INITIAL_POSITION",{x:100,y:100});this.position={...this.INITIAL_POSITION},this.velocity={...this.VELOCITY},this.element=this.createElement(t,e)}createElement(t,e){let i=document.createElement("a");return i.href=e,i.textContent=t,i.className="bouncing-text",i.addEventListener("mouseenter",()=>{this.isPaused=!0}),i.addEventListener("mouseleave",()=>{this.isPaused=!1}),document.body.appendChild(i),i}show(){this.element.style.display="block"}hide(){this.element.style.display="none"}update(){this.updatePosition(),this.updateColor(),this.applyStyles()}updatePosition(){if(this.isPaused)return;let t=this.element.getBoundingClientRect(),{width:e,height:i}=t;this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,(this.position.x<=0||this.position.x>=window.innerWidth-e)&&(this.velocity.x=-this.velocity.x,this.position.x=Math.max(0,Math.min(window.innerWidth-e,this.position.x))),(this.position.y<=0||this.position.y>=window.innerHeight-i)&&(this.velocity.y=-this.velocity.y,this.position.y=Math.max(0,Math.min(window.innerHeight-i,this.position.y)))}updateColor(){this.colorTransition+=this.COLOR_TRANSITION_SPEED,this.colorTransition>=1&&(this.colorTransition=0,this.currentColorIndex=(this.currentColorIndex+1)%this.COLORS.length);let t=this.hexToRgb(this.COLORS[this.currentColorIndex]),e=(this.currentColorIndex+1)%this.COLORS.length,i=this.hexToRgb(this.COLORS[e]);if(t&&i){let s=this.interpolateColor(t,i,this.colorTransition);this.element.style.color=`rgb(${s.r}, ${s.g}, ${s.b})`}}interpolateColor(t,e,i){return{r:Math.round(t.r+(e.r-t.r)*i),g:Math.round(t.g+(e.g-t.g)*i),b:Math.round(t.b+(e.b-t.b)*i)}}hexToRgb(t){let e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}applyStyles(){this.element.style.left=`${this.position.x}px`,this.element.style.top=`${this.position.y}px`}destroy(){this.element.remove()}},l=class{constructor(){r(this,"scene");r(this,"camera");r(this,"renderer");r(this,"controls");r(this,"room",null);r(this,"chair",null);r(this,"isRotating",!1);r(this,"targetRotation",0);r(this,"startRotation",0);r(this,"raycaster");r(this,"ROTATION_ANGLE",Math.PI/6);r(this,"ANIMATION_DURATION",1e3);r(this,"animationStartTime",0);r(this,"BOUNCEABLE_OBJECT_NAMES",["Mouse","Keyboard","KeyboardBase"]);r(this,"bounceableObjects",[]);r(this,"GRAVITY",-2.45);r(this,"DAMPENING",.6);r(this,"loadingBar");r(this,"loadedModel");r(this,"bouncingText");this.scene=new n.Scene,this.camera=new n.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new n.WebGLRenderer({antialias:!0,powerPreference:"high-performance"}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=n.PCFSoftShadowMap,this.renderer.outputColorSpace=n.SRGBColorSpace,this.renderer.toneMapping=n.NoToneMapping,this.renderer.toneMappingExposure=1.4,this.renderer.setPixelRatio(window.devicePixelRatio),document.body.appendChild(this.renderer.domElement),this.camera.position.set(4,4,4),this.camera.lookAt(0,0,0),this.controls=new m(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.enableZoom=!0,this.controls.enablePan=!1,this.controls.minPolarAngle=Math.PI/4,this.controls.maxPolarAngle=Math.PI/3,this.controls.minAzimuthAngle=Math.PI/6,this.controls.maxAzimuthAngle=Math.PI/3,this.setupLights(),this.raycaster=new n.Raycaster,this.loadingBar=new h,this.loadRoom(),this.bouncingText=new d("Consulting","/consulting.html"),this.setupEventListeners(),this.animate(performance.now())}setupLights(){let t=new n.AmbientLight(16777215,.4);this.scene.add(t)}setupWindowLight(t){let e=new n.Vector3;t.getWorldPosition(e),e.z-=.06,e.y+=.06;let i=new n.PointLight(16765582,1,0);i.position.copy(e),i.castShadow=!0,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,i.shadow.bias=-.001,this.scene.add(i)}setupLampLight(t){let e=new n.Vector3;t.getWorldPosition(e),e.y+=.06,e.z+=.04;let i=new n.PointLight(16765582,.1,5,1);i.castShadow=!0,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,i.shadow.bias=-.001,i.position.copy(e);let s=new n.SpotLight(16765582,1);s.position.copy(e),s.angle=Math.PI/4,s.penumbra=.2,s.decay=2,s.distance=10,s.castShadow=!0,s.shadow.mapSize.width=1024,s.shadow.mapSize.height=1024,s.shadow.bias=-.001;let a=new n.Object3D;this.scene.add(a),s.target=a,a.position.set(0,-1,0),this.scene.add(i),this.scene.add(s)}enhanceMaterial(t){!t.material||!(t.material instanceof n.MeshStandardMaterial)||(t.castShadow=!0,t.receiveShadow=!0,t.material.envMapIntensity=1.5,t.material.metalness=t.material.metalness||0,t.material.roughness=Math.max(.3,t.material.roughness||1),(t.name==="Glass"||t.name.includes("Glass"))&&(t.material.emissive=new n.Color(16765582),t.material.emissiveIntensity=.9),t.material.needsUpdate=!0)}loadRoom(){let t=new u,e=new g;e.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),e.setDecoderConfig({type:"js"}),t.setDRACOLoader(e),t.load("room.glb?v=1.0.0",i=>{this.loadedModel=i.scene,this.setupLoadedModel(),this.loadingBar.hide(()=>{this.room=this.loadedModel||null,this.room&&this.scene.add(this.room),this.bouncingText.show()})},i=>{if(i.lengthComputable){let s=i.loaded/i.total*100;this.loadingBar.updateProgress(s)}},i=>{console.error("Error loading room:",i),this.loadingBar.showError()})}setupLoadedModel(){if(!this.loadedModel)return;this.chair=this.loadedModel.getObjectByName("Chair")||null,this.chair&&(this.setupChairInteraction(),setTimeout(()=>this.startChairRotation(),1e3)),this.BOUNCEABLE_OBJECT_NAMES.forEach(i=>{let s=this.loadedModel?.getObjectByName(i);s&&this.setupBounceableObject(s)}),this.loadedModel.traverse(i=>{i.name==="WindowGlass"||i.name.includes("WindowGlass")?this.setupWindowLight(i):(i.name==="TableLampShade"||i.name.includes("TableLampShade"))&&this.setupLampLight(i),i instanceof n.Mesh&&this.enhanceMaterial(i)});let e=new n.Box3().setFromObject(this.loadedModel).getCenter(new n.Vector3);this.loadedModel.position.sub(e)}setupChairInteraction(){let t=new n.Vector2;window.addEventListener("click",e=>{t.x=e.clientX/window.innerWidth*2-1,t.y=-(e.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(t,this.camera),this.raycaster.intersectObject(this.chair,!0).length>0&&!this.isRotating&&this.startChairRotation()})}startChairRotation(){this.chair&&(this.startRotation=this.chair.rotation.y,this.targetRotation=Math.abs(this.startRotation)<.01?this.ROTATION_ANGLE:0,this.isRotating=!0,this.animationStartTime=performance.now())}updateChairRotation(t){if(!this.chair||!this.isRotating)return;let e=t-this.animationStartTime,i=Math.min(e/this.ANIMATION_DURATION,1);if(i<1){let s=this.easeInOutQuad(i);this.chair.rotation.y=this.startRotation+(this.targetRotation-this.startRotation)*s}else this.chair.rotation.y=this.targetRotation,this.isRotating=!1}setupBounceableObject(t){let e=new n.Vector3;t.getWorldPosition(e);let i=e.y;t.position.y=i+.3,this.bounceableObjects.push({object:t,initialY:i,velocity:0})}setupEventListeners(){window.addEventListener("resize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}),window.addEventListener("click",t=>{let e=new n.Vector2;e.x=t.clientX/window.innerWidth*2-1,e.y=-(t.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(e,this.camera);for(let i of this.bounceableObjects)if(this.raycaster.intersectObject(i.object,!0).length>0){i.velocity=.8;break}})}easeInOutQuad(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2}updateBounceableObjects(t){for(let e of this.bounceableObjects)e.velocity+=this.GRAVITY*t,e.object.position.y+=e.velocity*t,e.object.position.y<=e.initialY&&(e.object.position.y=e.initialY,e.velocity=-e.velocity*this.DAMPENING,Math.abs(e.velocity)<.01&&(e.velocity=0))}animate(t){requestAnimationFrame(e=>this.animate(e)),this.isRotating&&this.updateChairRotation(t),this.updateBounceableObjects(.016),this.bouncingText.update(),this.controls.update(),this.renderer.render(this.scene,this.camera)}};new l;
