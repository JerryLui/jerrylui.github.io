var m=Object.defineProperty;var l=(o,t,r)=>t in o?m(o,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):o[t]=r;var s=(o,t,r)=>l(o,typeof t!="symbol"?t+"":t,r);import*as e from"three";import{OrbitControls as p}from"three/addons/controls/OrbitControls.js";import{GLTFLoader as c}from"three/addons/loaders/GLTFLoader.js";import{DRACOLoader as w}from"three/addons/loaders/DRACOLoader.js";var h=class{constructor(){s(this,"scene");s(this,"camera");s(this,"renderer");s(this,"controls");s(this,"room",null);s(this,"axesHelper");this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new e.WebGLRenderer({antialias:!0,powerPreference:"high-performance"}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=e.PCFSoftShadowMap,this.renderer.outputColorSpace=e.SRGBColorSpace,this.renderer.toneMapping=e.ACESFilmicToneMapping,this.renderer.toneMappingExposure=1,this.renderer.setPixelRatio(window.devicePixelRatio),document.body.appendChild(this.renderer.domElement),this.camera.position.set(7.07,12,7.07),this.camera.lookAt(0,0,0),this.controls=new p(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.enableZoom=!0,this.controls.enablePan=!1,this.controls.minPolarAngle=Math.PI/4,this.controls.maxPolarAngle=Math.PI/3,this.controls.minAzimuthAngle=Math.PI/4,this.controls.maxAzimuthAngle=Math.PI/4,this.setupLights(),this.loadRoom(),this.setupEventListeners(),this.animate()}setupLights(){let t=new e.AmbientLight(16777215,.4);this.scene.add(t)}setupWindowLight(t){let r=new e.Vector3;t.getWorldPosition(r),r.z-=.06,r.y+=.06;let i=new e.PointLight(16765582,1,0);i.position.copy(r),i.castShadow=!0,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,i.shadow.bias=-.001,this.scene.add(i)}setupLampLight(t){let r=new e.Vector3;t.getWorldPosition(r),r.y+=.06,r.z+=.04;let i=new e.PointLight(16765582,.1,5,1);i.castShadow=!0,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,i.shadow.bias=-.001,i.position.copy(r);let a=new e.SpotLight(16765582,1);a.position.copy(r),a.angle=Math.PI/4,a.penumbra=.2,a.decay=2,a.distance=10,a.castShadow=!0,a.shadow.mapSize.width=1024,a.shadow.mapSize.height=1024,a.shadow.bias=-.001;let d=new e.Object3D;this.scene.add(d),a.target=d,d.position.set(0,-1,0),this.scene.add(i),this.scene.add(a)}enhanceMaterial(t){!t.material||!(t.material instanceof e.MeshStandardMaterial)||(t.castShadow=!0,t.receiveShadow=!0,t.material.envMapIntensity=1.5,t.material.metalness=t.material.metalness||0,t.material.roughness=Math.max(.3,t.material.roughness||1),(t.name==="Glass"||t.name.includes("Glass"))&&(t.material.emissive=new e.Color(16765582),t.material.emissiveIntensity=.9),t.material.needsUpdate=!0)}loadRoom(){let t=new c,r=new w;r.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),r.setDecoderConfig({type:"js"}),t.setDRACOLoader(r),t.load("room.glb",i=>{this.room=i.scene,this.scene.add(this.room),this.room.traverse(n=>{n.name==="WindowGlass"||n.name.includes("WindowGlass")?this.setupWindowLight(n):(n.name==="TableLampShade"||n.name.includes("TableLampShade"))&&this.setupLampLight(n),n instanceof e.Mesh&&this.enhanceMaterial(n)});let d=new e.Box3().setFromObject(this.room).getCenter(new e.Vector3);this.room.position.sub(d)},i=>{console.log("Loading progress:",i.loaded/i.total*100+"%")},i=>{console.error("Error loading room:",i)})}setupEventListeners(){window.addEventListener("resize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)})}animate(){requestAnimationFrame(()=>this.animate()),this.controls.update(),this.renderer.render(this.scene,this.camera)}};new h;
