var m=Object.defineProperty;var p=(n,t,e)=>t in n?m(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var o=(n,t,e)=>p(n,typeof t!="symbol"?t+"":t,e);import*as r from"three";import{OrbitControls as u}from"three/addons/controls/OrbitControls.js";import{GLTFLoader as E}from"three/addons/loaders/GLTFLoader.js";import{DRACOLoader as g}from"three/addons/loaders/DRACOLoader.js";var d=class{constructor(){o(this,"container");o(this,"progressBar");o(this,"currentProgress",0);o(this,"targetProgress",0);o(this,"MINIMUM_LOAD_TIME",2e3);o(this,"loadStartTime");o(this,"isAnimating",!0);o(this,"onComplete");o(this,"animate",()=>{this.isAnimating&&(this.targetProgress<90&&this.currentProgress<90&&(this.targetProgress+=.1),this.currentProgress+=(this.targetProgress-this.currentProgress)*.1,this.progressBar.style.width=`${this.currentProgress}%`,requestAnimationFrame(this.animate))});this.container=document.querySelector(".loading-bar"),this.progressBar=document.querySelector(".loading-progress"),this.loadStartTime=performance.now(),this.animate()}updateProgress(t){this.targetProgress=t}hide(t){this.onComplete=t;let e=performance.now()-this.loadStartTime,i=Math.max(0,this.MINIMUM_LOAD_TIME-e);this.targetProgress=100,setTimeout(()=>{this.isAnimating=!1,this.container.style.display="none",this.onComplete?.()},i)}showError(){this.container.style.backgroundColor="rgba(255, 0, 0, 0.3)",this.isAnimating=!1}},l=class{constructor(){o(this,"scene");o(this,"camera");o(this,"renderer");o(this,"controls");o(this,"room",null);o(this,"chair",null);o(this,"monitor",null);o(this,"isRotating",!1);o(this,"targetRotation",0);o(this,"startRotation",0);o(this,"raycaster");o(this,"ROTATION_ANGLE",Math.PI/6);o(this,"ANIMATION_DURATION",1e3);o(this,"animationStartTime",0);o(this,"BOUNCEABLE_OBJECT_NAMES",["Mouse","Keyboard","KeyboardBase"]);o(this,"bounceableObjects",[]);o(this,"GRAVITY",-2.45);o(this,"DAMPENING",.6);o(this,"loadingBar");o(this,"loadedModel");o(this,"tooltip");this.scene=new r.Scene,this.camera=new r.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new r.WebGLRenderer({antialias:!0,powerPreference:"high-performance"}),this.tooltip=document.getElementById("monitor-tooltip"),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=r.PCFSoftShadowMap,this.renderer.outputColorSpace=r.SRGBColorSpace,this.renderer.toneMapping=r.NoToneMapping,this.renderer.toneMappingExposure=1.4,this.renderer.setPixelRatio(window.devicePixelRatio),document.body.appendChild(this.renderer.domElement),this.camera.position.set(4,4,4),this.camera.lookAt(0,0,0),this.controls=new u(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.enableZoom=!0,this.controls.enablePan=!1,this.controls.minPolarAngle=Math.PI/4,this.controls.maxPolarAngle=Math.PI/3,this.controls.minAzimuthAngle=Math.PI/6,this.controls.maxAzimuthAngle=Math.PI/3,this.setupLights(),this.raycaster=new r.Raycaster,this.loadingBar=new d,this.loadRoom(),this.setupEventListeners(),this.animate(performance.now())}setupLights(){let t=new r.AmbientLight(16777215,.4);this.scene.add(t)}setupWindowLight(t){let e=new r.Vector3;t.getWorldPosition(e),e.z-=.06,e.y+=.06;let i=new r.PointLight(16765582,1,0);i.position.copy(e),i.castShadow=!0,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,i.shadow.bias=-.001,this.scene.add(i)}setupLampLight(t){let e=new r.Vector3;t.getWorldPosition(e),e.y+=.06,e.z+=.04;let i=new r.PointLight(16765582,.1,5,1);i.castShadow=!0,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,i.shadow.bias=-.001,i.position.copy(e);let s=new r.SpotLight(16765582,1);s.position.copy(e),s.angle=Math.PI/4,s.penumbra=.2,s.decay=2,s.distance=10,s.castShadow=!0,s.shadow.mapSize.width=1024,s.shadow.mapSize.height=1024,s.shadow.bias=-.001;let a=new r.Object3D;this.scene.add(a),s.target=a,a.position.set(0,-1,0),this.scene.add(i),this.scene.add(s)}enhanceMaterial(t){!t.material||!(t.material instanceof r.MeshStandardMaterial)||(t.castShadow=!0,t.receiveShadow=!0,t.material.envMapIntensity=1.5,t.material.metalness=t.material.metalness||0,t.material.roughness=Math.max(.3,t.material.roughness||1),(t.name==="Glass"||t.name.includes("Glass"))&&(t.material.emissive=new r.Color(16765582),t.material.emissiveIntensity=.9),t.material.needsUpdate=!0)}loadRoom(){let t=new E,e=new g;e.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),e.setDecoderConfig({type:"js"}),t.setDRACOLoader(e),t.load("room.glb?v=1.0.0",i=>{this.loadedModel=i.scene,this.setupLoadedModel(),this.loadingBar.hide(()=>{this.room=this.loadedModel||null,this.room&&this.scene.add(this.room)})},i=>{if(i.lengthComputable){let s=i.loaded/i.total*100;this.loadingBar.updateProgress(s)}},i=>{console.error("Error loading room:",i),this.loadingBar.showError()})}setupLoadedModel(){if(!this.loadedModel)return;this.chair=this.loadedModel.getObjectByName("Chair")||null,this.chair&&(this.setupChairInteraction(),setTimeout(()=>this.startChairRotation(),1e3)),this.monitor=this.loadedModel.getObjectByName("Monitor")||null,this.monitor&&(this.setupMonitorGlow(),this.setupMonitorInteraction()),this.BOUNCEABLE_OBJECT_NAMES.forEach(i=>{let s=this.loadedModel?.getObjectByName(i);s&&this.setupBounceableObject(s)}),this.loadedModel.traverse(i=>{i.name==="WindowGlass"||i.name.includes("WindowGlass")?this.setupWindowLight(i):(i.name==="TableLampShade"||i.name.includes("TableLampShade"))&&this.setupLampLight(i),i instanceof r.Mesh&&this.enhanceMaterial(i)});let e=new r.Box3().setFromObject(this.loadedModel).getCenter(new r.Vector3);this.loadedModel.position.sub(e)}setupChairInteraction(){let t=new r.Vector2;window.addEventListener("click",e=>{t.x=e.clientX/window.innerWidth*2-1,t.y=-(e.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(t,this.camera),this.raycaster.intersectObject(this.chair,!0).length>0&&!this.isRotating&&this.startChairRotation()})}startChairRotation(){this.chair&&(this.startRotation=this.chair.rotation.y,this.targetRotation=Math.abs(this.startRotation)<.01?this.ROTATION_ANGLE:0,this.isRotating=!0,this.animationStartTime=performance.now())}setupMonitorGlow(){this.monitor&&this.monitor.traverse(t=>{if(t instanceof r.Mesh){let e=t.material;e instanceof r.MeshStandardMaterial&&(e.emissive=new r.Color(5089023),e.emissiveIntensity=.1,e.needsUpdate=!0)}})}setupMonitorInteraction(){this.renderer.domElement.addEventListener("mousemove",t=>{this.handleMonitorHover(t)}),this.renderer.domElement.addEventListener("click",t=>{this.handleMonitorClick(t)})}handleMonitorHover(t){if(!this.monitor)return;let e=new r.Vector2,i=this.renderer.domElement.getBoundingClientRect();e.x=(t.clientX-i.left)/i.width*2-1,e.y=-((t.clientY-i.top)/i.height)*2+1,this.raycaster.setFromCamera(e,this.camera),this.raycaster.intersectObject(this.monitor,!0).length>0?(this.tooltip.style.display="block",this.tooltip.style.left=t.clientX+10+"px",this.tooltip.style.top=t.clientY-30+"px",this.renderer.domElement.style.cursor="pointer"):(this.tooltip.style.display="none",this.renderer.domElement.style.cursor="default")}handleMonitorClick(t){if(!this.monitor)return;let e=new r.Vector2,i=this.renderer.domElement.getBoundingClientRect();e.x=(t.clientX-i.left)/i.width*2-1,e.y=-((t.clientY-i.top)/i.height)*2+1,this.raycaster.setFromCamera(e,this.camera),this.raycaster.intersectObject(this.monitor,!0).length>0&&(window.location.href="/consulting.html")}updateChairRotation(t){if(!this.chair||!this.isRotating)return;let e=t-this.animationStartTime,i=Math.min(e/this.ANIMATION_DURATION,1);if(i<1){let s=this.easeInOutQuad(i);this.chair.rotation.y=this.startRotation+(this.targetRotation-this.startRotation)*s}else this.chair.rotation.y=this.targetRotation,this.isRotating=!1}setupBounceableObject(t){let e=new r.Vector3;t.getWorldPosition(e);let i=e.y;t.position.y=i+.3,this.bounceableObjects.push({object:t,initialY:i,velocity:0})}setupEventListeners(){window.addEventListener("resize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}),window.addEventListener("click",t=>{let e=new r.Vector2;e.x=t.clientX/window.innerWidth*2-1,e.y=-(t.clientY/window.innerHeight)*2+1,this.raycaster.setFromCamera(e,this.camera);for(let i of this.bounceableObjects)if(this.raycaster.intersectObject(i.object,!0).length>0){i.velocity=.8;break}})}easeInOutQuad(t){return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2}updateBounceableObjects(t){for(let e of this.bounceableObjects)e.velocity+=this.GRAVITY*t,e.object.position.y+=e.velocity*t,e.object.position.y<=e.initialY&&(e.object.position.y=e.initialY,e.velocity=-e.velocity*this.DAMPENING,Math.abs(e.velocity)<.01&&(e.velocity=0))}updateMonitorGlow(t){if(!this.monitor)return;let a=.05+Math.sin(t*.002)*.05;this.monitor.traverse(c=>{if(c instanceof r.Mesh){let h=c.material;h instanceof r.MeshStandardMaterial&&h.emissive&&(h.emissiveIntensity=Math.max(0,a))}})}animate(t){requestAnimationFrame(e=>this.animate(e)),this.isRotating&&this.updateChairRotation(t),this.updateBounceableObjects(.016),this.updateMonitorGlow(t),this.controls.update(),this.renderer.render(this.scene,this.camera)}};new l;
