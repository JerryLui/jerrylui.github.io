var p=Object.defineProperty;var m=(o,t,i)=>t in o?p(o,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[t]=i;var n=(o,t,i)=>m(o,typeof t!="symbol"?t+"":t,i);import*as e from"three";import{OrbitControls as E}from"three/addons/controls/OrbitControls.js";import{GLTFLoader as w}from"three/addons/loaders/GLTFLoader.js";import{DRACOLoader as l}from"three/addons/loaders/DRACOLoader.js";var h=class{constructor(){n(this,"scene");n(this,"camera");n(this,"renderer");n(this,"controls");n(this,"room",null);n(this,"axesHelper");this.scene=new e.Scene,this.camera=new e.PerspectiveCamera(45,window.innerWidth/window.innerHeight,.1,1e3),this.renderer=new e.WebGLRenderer({antialias:!0,powerPreference:"high-performance"}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=e.PCFSoftShadowMap,this.renderer.outputColorSpace=e.SRGBColorSpace,this.renderer.toneMapping=e.ACESFilmicToneMapping,this.renderer.toneMappingExposure=1,this.renderer.setPixelRatio(window.devicePixelRatio),document.body.appendChild(this.renderer.domElement),this.camera.position.set(7.07,12,7.07),this.camera.lookAt(0,0,0),this.controls=new E(this.camera,this.renderer.domElement),this.controls.enableDamping=!0;let t=new e.AxesHelper(1);this.axesHelper=t,this.scene.add(t),this.setupLights(),this.loadRoom(),this.setupEventListeners(),this.animate()}setupLights(){let t=new e.AmbientLight(16777215,.2);this.scene.add(t)}setupWindowLight(t){let i=new e.Vector3;t.getWorldPosition(i),i.z-=.06,i.y+=.06;let r=new e.PointLight(16765582,1,0);r.position.copy(i),r.castShadow=!0,r.shadow.mapSize.width=1024,r.shadow.mapSize.height=1024,r.shadow.bias=-.001,this.scene.add(r)}setupLampLight(t){let i=new e.Vector3;t.getWorldPosition(i),i.y+=.06,i.z+=.04;let r=new e.PointLight(16765582,.1,5,1);r.castShadow=!0,r.shadow.mapSize.width=1024,r.shadow.mapSize.height=1024,r.shadow.bias=-.001,r.position.copy(i);let s=new e.SpotLight(16765582,1);s.position.copy(i),s.angle=Math.PI/4,s.penumbra=.2,s.decay=2,s.distance=10,s.castShadow=!0,s.shadow.mapSize.width=1024,s.shadow.mapSize.height=1024,s.shadow.bias=-.001;let d=new e.Object3D;this.scene.add(d),s.target=d,d.position.set(0,-1,0),this.axesHelper.position.copy(i),this.scene.add(r),this.scene.add(s)}enhanceMaterial(t){!t.material||!(t.material instanceof e.MeshStandardMaterial)||(t.castShadow=!0,t.receiveShadow=!0,t.material.envMapIntensity=1.5,t.material.metalness=t.material.metalness||0,t.material.roughness=Math.max(.3,t.material.roughness||1),(t.name==="Glass"||t.name.includes("Glass"))&&(t.material.emissive=new e.Color(16765582),t.material.emissiveIntensity=.9),t.material.needsUpdate=!0)}loadRoom(){let t=new w,i=new l;i.setDecoderPath("https://www.gstatic.com/draco/versioned/decoders/1.5.6/"),i.setDecoderConfig({type:"js"}),t.setDRACOLoader(i),t.load("room.glb",r=>{this.room=r.scene,this.scene.add(this.room),this.room.traverse(a=>{a.name==="WindowGlass"||a.name.includes("WindowGlass")?this.setupWindowLight(a):(a.name==="Lampshade"||a.name.includes("Lampshade"))&&this.setupLampLight(a),a instanceof e.Mesh&&this.enhanceMaterial(a)});let d=new e.Box3().setFromObject(this.room).getCenter(new e.Vector3);this.room.position.sub(d)},r=>{console.log("Loading progress:",r.loaded/r.total*100+"%")},r=>{console.error("Error loading room:",r)})}setupEventListeners(){window.addEventListener("resize",()=>{this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)})}animate(){requestAnimationFrame(()=>this.animate()),this.controls.update(),this.renderer.render(this.scene,this.camera)}};new h;
